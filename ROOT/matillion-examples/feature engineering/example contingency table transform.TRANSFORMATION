{"job":{"components":{"1251":{"id":1251,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":335239555,"x":1280,"y":224,"width":32,"height":32,"inputConnectorIDs":[1258],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Flight delay analysis - summary data"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"summary_flight_delay"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"8":{"slot":8,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"9":{"slot":9,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1293":{"id":1293,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":449,"y":378,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1255],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"All flights"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"stg_training_flights"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flight_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"crs_departure_time"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"arrival_time"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"crs_arrival_time"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"flight_number"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"origin"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"destination"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"actual_elapsed_time"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"airtime"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1294":{"id":1294,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":609,"y":218,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[1256],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us_holiday_observance"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us_holiday_observance"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CalendarDate"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Observance"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1295":{"id":1295,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":609,"y":378,"width":32,"height":32,"inputConnectorIDs":[1255,1256],"outputConnectorIDs":[1253],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Fed Holidays"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"All flights"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"f"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"us_holiday_observance"},"2":{"slot":2,"type":"STRING","value":"ob"},"3":{"slot":3,"type":"STRING","value":"Left"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"f\".\"flight_date\" = \"ob\".\"CalendarDate\""},"2":{"slot":2,"type":"STRING","value":"f_Left_ob"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"f.flight_date"},"2":{"slot":2,"type":"STRING","value":"flight_date"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"f.crs_departure_time"},"2":{"slot":2,"type":"STRING","value":"crs_departure_time"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"f.arrival_time"},"2":{"slot":2,"type":"STRING","value":"arrival_time"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"f.crs_arrival_time"},"2":{"slot":2,"type":"STRING","value":"crs_arrival_time"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"f.flight_number"},"2":{"slot":2,"type":"STRING","value":"flight_number"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"f.airtime"},"2":{"slot":2,"type":"STRING","value":"airtime"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"f.origin"},"2":{"slot":2,"type":"STRING","value":"origin"}}},"8":{"slot":8,"values":{"1":{"slot":1,"type":"STRING","value":"f.destination"},"2":{"slot":2,"type":"STRING","value":"destination"}}},"9":{"slot":9,"values":{"1":{"slot":1,"type":"STRING","value":"f.actual_elapsed_time"},"2":{"slot":2,"type":"STRING","value":"actual_elapsed_time"}}},"10":{"slot":10,"values":{"1":{"slot":1,"type":"STRING","value":"ob.Observance"},"2":{"slot":2,"type":"STRING","value":"Observance"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1296":{"id":1296,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":737,"y":298,"width":32,"height":32,"inputConnectorIDs":[1253],"outputConnectorIDs":[1257],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Business Rules"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"arrival_time"},"2":{"slot":2,"type":"STRING","value":"Not"},"3":{"slot":3,"type":"STRING","value":"Null"},"4":{"slot":4,"type":"STRING","value":""}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"crs_arrival_time"},"2":{"slot":2,"type":"STRING","value":"Not"},"3":{"slot":3,"type":"STRING","value":"Null"},"4":{"slot":4,"type":"STRING","value":""}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"airtime"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1297":{"id":1297,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":849,"y":298,"width":32,"height":32,"inputConnectorIDs":[1257],"outputConnectorIDs":[1252,1254],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Binning"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"60 * CAST((\"crs_arrival_time\" - MOD(\"crs_arrival_time\", 100)) / 100 AS INTEGER) + MOD(\"crs_arrival_time\", 100)"},"2":{"slot":2,"type":"STRING","value":"crs_arrival_mpm"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"60 * CAST((\"arrival_time\" - MOD(\"arrival_time\", 100)) / 100 AS INTEGER) + MOD(\"arrival_time\", 100)"},"2":{"slot":2,"type":"STRING","value":"arrival_mpm"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"CASE\n     /* Flights due to arrive late evening and actually arriving next day */\n     WHEN \"arrival_mpm\" - \"crs_arrival_mpm\" < -500\n     THEN \"arrival_mpm\" - \"crs_arrival_mpm\" + 1440\n     /* Flights due to arrive early morning but actually arriving the evening of the day before */\n     WHEN \"arrival_mpm\" - \"crs_arrival_mpm\" > 1200\n     THEN \"arrival_mpm\" - \"crs_arrival_mpm\" - 1440\n     /* For most flights the day is the same */\n     ELSE \"arrival_mpm\" - \"crs_arrival_mpm\"\nEND"},"2":{"slot":2,"type":"STRING","value":"DelayMinutes"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"DelayMinutes\" >= 45 THEN 'Large Delay'\n     WHEN \"DelayMinutes\" >= 15 THEN 'Medium Delay'\n     ELSE 'On Time'\nEND"},"2":{"slot":2,"type":"STRING","value":"LatenessCategory"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"Observance\" IS NULL THEN 'No Holiday'\n     ELSE 'Holiday'\nEND"},"2":{"slot":2,"type":"STRING","value":"HolidayCategory"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1298":{"id":1298,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":1009,"y":218,"width":32,"height":32,"inputConnectorIDs":[1254],"outputConnectorIDs":[1259],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Top level aggregation"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LatenessCategory"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"HolidayCategory"}}}},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flight_date"},"2":{"slot":2,"type":"STRING","value":"Count"}}}},"visible":true},"4":{"slot":4,"name":"Grouping Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Group By"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1299":{"id":1299,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-319648201,"x":1009,"y":378,"width":32,"height":32,"inputConnectorIDs":[1252],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Flight delay analysis - granular data (view)"}}}},"visible":true},"2":{"slot":2,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${examples_schema}"}}}},"visible":true},"3":{"slot":3,"name":"View Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"v_flight_delay_analysis"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Secure View","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"7":{"slot":7,"name":"View Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"1300":{"id":1300,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":609793074,"x":1136,"y":224,"width":32,"height":32,"inputConnectorIDs":[1259],"outputConnectorIDs":[1258],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Proportions"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"HolidayCategory"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{},"visible":true},"5":{"slot":5,"name":"Lower Bound","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Upper Bound","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"7":{"slot":7,"name":"Lower Bound Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"8":{"slot":8,"name":"Upper Bound Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"9":{"slot":9,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Sum"},"2":{"slot":2,"type":"STRING","value":"count_flight_date"},"3":{"slot":3,"type":"STRING","value":"CountByHolidayCategory"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"1252":{"id":1252,"sourceID":1297,"targetID":1299},"1253":{"id":1253,"sourceID":1295,"targetID":1296},"1254":{"id":1254,"sourceID":1297,"targetID":1298},"1255":{"id":1255,"sourceID":1293,"targetID":1295},"1256":{"id":1256,"sourceID":1294,"targetID":1295},"1257":{"id":1257,"sourceID":1296,"targetID":1297},"1258":{"id":1258,"sourceID":1300,"targetID":1251},"1259":{"id":1259,"sourceID":1298,"targetID":1300}},"notes":{"1291":{"id":1291,"x":519,"y":169,"width":395,"height":255,"text":"These are the business rules and definitions that need to be shared","colour":"00ce4f"},"1292":{"id":1292,"x":286,"y":194,"width":143,"height":78,"text":"Run the \"example contingency table setup\" job first to create the database objects","colour":"e6e63c"}},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"example contingency table transform","description":null,"type":"TRANSFORMATION","tag":"5fa5191a-e6cc-477a-9740-8e4d0d4bcccd"}}